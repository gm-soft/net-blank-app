<app-page-header>
  <div class="w-100 d-flex justify-content-between">
    <div class="app-page-header-label">Projects report</div>
  </div>
</app-page-header>

<div class="p-3 mt-3" *ngIf="projectsReportItems != null">
  <div class="table-responsive">
    <table
      class="table table-stripped table-hover table-bordered table-sm"
      *ngIf="projectsReportItems.length > 0; else noItems"
    >
      <thead>
        <tr>
          <th scope="col">#</th>
          <th>Name</th>
          <th>End Date</th>
          <th>Margin</th>
          <th title="Contract price">Contract</th>
          <th>Budget</th>
          <th title="Project Staff Cost">Staff Cost</th>
          <th title="Total Project Cost">Total Cost</th>
          <th>Actual Staff Cost</th>
          <th>Profit</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let item of projectsReportItems; let i = index">
          <th scope="row">{{ i + 1 }}</th>
          <td>
            <a routerLink="/projects/{{ item.projectId }}" title="{{ item.projectName }}">{{ item.projectCode }}</a>
          </td>
          <td>{{ item.to == null ? '-' : (item.to | date: 'yyyy-MM-dd') }}</td>
          <td><app-finance-value [content]="item.margin" [title]="item.marginRate + '%'"></app-finance-value></td>
          <td><app-finance-value [content]="item.contractPrice"></app-finance-value></td>
          <td><app-finance-value [content]="item.budget"></app-finance-value></td>
          <td><app-finance-value [content]="item.projectStaffCost"></app-finance-value></td>
          <td><app-finance-value [content]="item.projectTotalCost"></app-finance-value></td>
          <td><app-finance-value [content]="item.actualStaffCost"></app-finance-value></td>
          <td><app-finance-value [content]="item.profit" [decorate]="true"></app-finance-value></td>
        </tr>
        <tr *ngIf="totalValues != null">
          <td></td>
          <th>Total</th>
          <td></td>
          <td><app-finance-value [content]="totalValues.totalMargin"></app-finance-value></td>
          <td><app-finance-value [content]="totalValues.totalContractPrice"></app-finance-value></td>
          <td><app-finance-value [content]="totalValues.totalBudget"></app-finance-value></td>
          <td><app-finance-value [content]="totalValues.totalProjectStaffCost"></app-finance-value></td>
          <td><app-finance-value [content]="totalValues.totalProjectsCost"></app-finance-value></td>
          <td><app-finance-value [content]="totalValues.totalActualStaffCost"></app-finance-value></td>
          <td><app-finance-value [content]="totalValues.totalProfit" [decorate]="true"></app-finance-value></td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #noItems>
    <app-nothing-to-show-label></app-nothing-to-show-label>
  </ng-template>
</div>
