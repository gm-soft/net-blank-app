<div *ngIf="departmentEmployees != null">
  <h5>Employees: {{ activeEmployeesCount }}</h5>

  <div class="mt-3">
    <div class="">
      <table
        class="table table-striped table-bordered table-hover"
        *ngIf="departmentEmployees.length > 0; else noOneEmployee"
      >
        <thead>
          <tr>
            <th scope="col">#</th>
            <th>Name</th>
            <th>Role</th>
            <th>From</th>
            <th>To</th>
            <th *ngIf="showActiveStatusLabel">Status</th>
            <th *ngIf="showActions">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let departmentEmployee of departmentEmployees; let i = index">
            <th scope="row">{{ i + 1 }}</th>
            <td>
              <a routerLink="/users/{{ departmentEmployee.userId }}">{{ departmentEmployee.fullName }}</a>
            </td>
            <td>{{ departmentEmployee.role }}</td>
            <td>{{ departmentEmployee.from | date: 'yyyy-MM-dd' }}</td>
            <td>
              <div class="input-group">
                <input
                  class="form-control"
                  placeholder="yyyy-mm-dd"
                  autocomplete="off"
                  name="to"
                  [(ngModel)]="departmentEmployee.to"
                  ngbDatepicker
                  [disabled]="!departmentEmployee.isEditable"
                  #endDatePicker="ngbDatepicker"
                />
                <div *ngIf="departmentEmployee.isEditable" class="input-group-append">
                  <button
                    class="btn btn-outline-secondary calendar"
                    (click)="endDatePicker.toggle()"
                    type="button"
                    title="Pick"
                  >
                    <i class="far fa-calendar-alt"></i>
                  </button>
                </div>
              </div>
              <div class="my-1" *ngIf="departmentEmployee.invalidLimits()">
                <p class="alert alert-danger small">
                  <strong>To date should be greater than From date.</strong><br />
                  Please double-check the from and to dates.
                </p>
              </div>
            </td>
            <td *ngIf="showActiveStatusLabel">
              <div *ngIf="!departmentEmployee.isInactive" class="badge badge-success">
                Active
              </div>
              <div *ngIf="departmentEmployee.isInactive" class="badge badge-warning">
                Inactive
              </div>
            </td>
            <td *ngIf="showActions">
              <div class="d-inline-block" *ngIf="departmentEmployee.isEditable">
                <button
                  class="btn btn-sm btn-success"
                  *ngIf="departmentEmployee.isEditable"
                  title="Save"
                  (click)="save(departmentEmployee)"
                >
                  <i class="far fa-save"></i>
                </button>
                <button
                  class="btn btn-sm btn-outline-secondary ml-1 mr-1"
                  *ngIf="departmentEmployee.isEditable"
                  title="Cancel"
                  (click)="departmentEmployee.cancel()"
                >
                  <i class="fa fa-lg fa-times"></i>
                </button>
              </div>

              <button
                class="btn btn-sm btn-outline-secondary"
                *ngIf="!departmentEmployee.isEditable && !departmentEmployee.isInactive"
                (click)="departmentEmployee.isEditable = true"
                title="Edit participant's 'To' date"
              >
                <i class="fa fa-pen"></i>
              </button>

              <button
                *ngIf="!departmentEmployee.isInactive && showRemoveButton"
                type="button"
                class="btn btn-sm btn-warning ml-1"
                (click)="makeEmployeeInactive(departmentEmployee)"
                title="Make the user participation outdated"
              >
                <i class="fas fa-archive"></i>
              </button>
              <button
                *ngIf="showRemoveFromDatabaseBtn"
                type="button"
                class="btn btn-sm btn-outline-danger ml-1"
                (click)="removeEmployeeFromDatabase(departmentEmployee)"
                title="Remove department employee from the database"
              >
                <i class="far fa-trash-alt"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <ng-template #noOneEmployee>
      No one employee
    </ng-template>
  </div>
</div>

<app-confirm-dialog *ngIf="confirmDeletionMessage != null" [message]="confirmDeletionMessage"></app-confirm-dialog>
